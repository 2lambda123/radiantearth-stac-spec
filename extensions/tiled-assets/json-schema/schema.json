{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "stac-extension-tiled-assets.json#",
  "title": "Tiled Assets Extension",
  "description": "Tiled Assets Extension to a STAC Item",
  "allOf": [
    {
      "$ref": "../../../item-spec/json-schema/item.json#/definitions/core"
    },
    {
      "$ref": "#/definitions/tl"
    }
  ],
  "definitions": {
    "tl": {
      "type": "object",
      "required": [
        "properties"
      ],
      "properties": {
        "properties": {
          "type": "object",
          "required": [],
          "properties": {
            "tl:tileMatrixSet": {
              "title": "A list of all available tile matrix sets.",
              "type": "array",
              "items": {
                "$ref": "#/definitions/tileMatrixSet"
              }
            },
            "tl:dimensions": {
              "title": "Additional dimensions",
              "type": "object",
              "patternProperties": {
                "[a-zA-Z0-9]+": {
                  "$ref": "#/definitions/dimension"
                }
              },
              "additionalProperties": false
            }
          }
        }
      },
      "assetTemplates": {
        "title": "Asset link templates",
        "description": "Link templates to assets",
        "type": "object",
        "patternProperties": {
          ".+": {
            "$ref": "#/definitions/assetTemplate"
          }
        },
        "additionalProperties": false
      }
    },
    "assetTemplate": {
      "type": "object",
      "required": [
        "hrefTemplate"
      ],
      "properties": {
        "hrefTemplate": {
          "title": "Asset reference template",
          "type": "string"
        },
        "title": {
          "title": "Asset title",
          "type": "string"
        },
        "type": {
          "title": "Asset type",
          "type": "string"
        }
      }
    },
    "tileMatrixSet": {
      "type": "object",
      "required": ["type", "identifier", "supportedCRS", "tileMatrix"],
      "properties": {
        "type": {
          "type": "string",
          "description": "Type of the Tile Matrix Set. Fixed to `TileMatrixSetType`",
          "const": "TileMatrixSetType"
        },
        "title": {
          "type": "string",
          "description": "Title of this tile matrix set, normally used for display to a human"
        },
        "abstract": {
          "type": "string",
          "description": "Brief narrative description of this tile matrix set, normally available for display to a human"
        },
        "keywords": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Unordered list of one or more commonly used or formalized word(s) or phrase(s) used to describe this dataset"
        },
        "identifier": {
          "type": "string",
          "description": "Tile matrix set identifier. This can be used as the `TileMatrixSet` template parameter."
        },
        "boundingBox": {
          "type": "object",
          "description": "Minimum bounding rectangle surrounding the tile matrix set, in the supported CRS",
          "$ref": "#/definitions/boundingBox"
        },
        "supportedCRS": {
          "type": "string",
          "description": "Reference to one coordinate reference system (CRS)"
        },
        "wellKnownScaleSet": {
          "type": "string",
          "description": "Reference to a well-known scale set."
        },
        "tileMatrix": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/tileMatrix"
          },
          "description": "An array of tile matrix objects, describing the tile matrices of the resolution layers of the tile matrix set."
        },
        "pixelBuffer": {
          "type": "object",
          "description": "An optional default pixel buffer description object. By default, no pixel buffers are used.",
          "$ref": "#/definitions/pixelBuffer"
        }
      }
    },
    "dimension": {
      "type": "object",
      "anyOf": [
        {
          "required": [
            "positions"
          ]
        },
        {
          "required": [
            "start",
            "stop",
            "step"
          ]
        }
      ],
      "properties": {
        "positions": {
          "title": "The discrete possible values of that dimension.",
          "type": "array",
          "items": {
            "type": [
              "string",
              "number"
            ],
            "pattern": "[a-zA-Z0-9]+"
          }
        },
        "start": {
          "title": "The first possible value of that particular dimension. Either a numeric or an ISO 8601 date or datetime.",
          "type": [
            "string",
            "number"
          ]
        },
        "stop": {
          "title": "The last possible value of that particular dimension. Either a numeric or an ISO 8601 date or datetime.",
          "type": [
            "string",
            "number"
          ]
        },
        "steps": {
          "title": "The number of steps in that dimension, including the `start` and `stop` values as borders.",
          "type": "integer",
          "minimum": 1
        }
      }
    },
    "boundingBox": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "description": "Type of the Bounding Box. Fixed to `BoundingBoxType`",
          "const": "BoundingBoxType"
        },
        "lowerCorner": {
          "type": "array",
          "items": {
            "type": "number"
          },
          "description": "The lower corner of this bounding box."
        },
        "upperCorner": {
          "type": "array",
          "items": {
            "type": "number"
          },
          "description": "The upper corner of this bounding box."
        }
      }
    },
    "tileMatrix": {
      "type": "object",
      "required": [
        "type",
        "identifier",
        "scaleDenominator",
        "topLeftCorner",
        "tileWidth",
        "tileHeight",
        "matrixWidth",
        "matrixHeight"
      ],
      "properties": {
        "type": {
          "type": "string",
          "description": "Type of the Tile Matrix. Fixed to `TileMatrixType`",
          "const": "TileMatrixType"
        },
        "title": {
          "type": "string",
          "description": "Title of this tile matrix set, normally used for display to a human"
        },
        "abstract": {
          "type": "string",
          "description": "Brief narrative description of this tile matrix, normally available for display to a human"
        },
        "keywords": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Unordered list of one or more commonly used or formalized word(s) or phrase(s) used to describe this dataset"
        },
        "identifier": {
          "type": "string",
          "description": "Tile matrix identifier. This identifier can be used in templates to replace `{TileMatrix}` parameters."
        },
        "scaleDenominator": {
          "type": "string",
          "description": "Scale denominator level of this tile matrix."
        },
        "topLeftCorner": {
          "type": "array",
          "items": {
            "type": "number"
          },
          "description": "Position in CRS coordinates of the top-left corner of this tile matrix."
        },
        "tileWidth": {
          "type": "integer",
          "minimum": 1,
          "description": "Width of each tile of this tile matrix in pixels. Pixel buffers are not reflected in this number."
        },
        "tileHeight": {
          "type": "integer",
          "minimum": 1,
          "description": "Height of each tile of this tile matrix in pixels. Pixel buffers are not reflected in this number."
        },
        "matrixWidth": {
          "type": "integer",
          "minimum": 1,
          "description": "The number of columns in this tile matrix. Any number between zero and `matrixWidth - 1` can be used to replace the `{tileCol}` template parameter."
        },
        "matrixHeight": {
          "type": "integer",
          "minimum": 1,
          "description": "The number of rows in this tile matrix. Any number between zero and `matrixHeight - 1` can be used to replace the `{tileRow}` template parameter."
        },
        "variableMatrixWidth": {
          "type": "object",
          "description": "Describes the rows that has variable matix width.",
          "$ref": "#/definitions/variableMatrixWidth"
        },
        "pixelBuffer": {
          "type": "object",
          "description": "An optional default pixel buffer description object, overriding the default of the pyramid. By default, no pixel buffers are used.",
          "$ref": "#/definitions/pixelBuffer"
        }
      }
    },
    "pixelBuffer": {
      "type": "object",
      "properties": {
        "top": {
          "type": "integer",
          "description": "The size of the pixel-buffer in the top border of the image. Default is `0`.",
          "minimum": 0
        },
        "left": {
          "type": "integer",
          "description": "The size of the pixel-buffer in the left border of the image. Default is `0`.",
          "minimum": 0
        },
        "bottom": {
          "type": "integer",
          "description": "The size of the pixel-buffer in the bottom border of the image. Default is `0`.",
          "minimum": 0
        },
        "right": {
          "type": "integer",
          "description": "The size of the pixel-buffer in the right border of the image. Default is `0`.",
          "minimum": 0
        },
        "borderTop": {
          "type": "boolean",
          "description": "Whether or not the pixelbuffer is included images on the top border of the first tile row. Default is `true`."
        },
        "borderLeft": {
          "type": "boolean",
          "description": "Whether or not the pixelbuffer is included images on the left border of the first tile column. Default is `true`."
        },
        "borderBottom": {
          "type": "boolean",
          "description": "Whether or not the pixelbuffer is included images on the bottom border of the last tile row. Default is `true`."
        },
        "borderRight": {
          "type": "boolean",
          "description": "Whether or not the pixelbuffer is included images on the right border of the last tile row. Default is `true`."
        }
      }
    },
    "variableMatrixWidth": {
      "type": "object",
      "required": [
        "type",
        "coalesce",
        "minTileRow",
        "maxTileRow"
      ],
      "properties": {
        "type": {
          "type": "string",
          "description": "Type of the Variable Matrix Width. Fixed to `VariableMatrixWidthType`",
          "const": "VariableMatrixWidthType"
        },
        "coalesce": {
          "type": "number",
          "description": "Coalescence factor"
        },
        "minTileRow": {
          "type": "integer",
          "description": "Minimum tile row index valid for this layer"
        },
        "maxTileRow": {
          "type": "integer",
          "description": "Maximum tile row index valid for this layer"
        }
      }

    }
  }
}